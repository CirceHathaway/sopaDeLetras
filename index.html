<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sopa de Letras - Desaf√≠o Mental</title>
    <!-- Enlace a los estilos CSS -->
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#764ba2">
    <link rel="apple-touch-icon" href="icon-192.png">
</head>
<body>

    <div id="background-animation"></div>

    <!-- MEN√ö PRINCIPAL -->
    <div id="menu-screen">
        <!-- T√çTULO ANIMADO CON FICHAS -->
        <div class="title-container">
            <div class="title-row">
                <div class="title-tile" style="animation-delay: 0.1s">S</div>
                <div class="title-tile" style="animation-delay: 0.2s">O</div>
                <div class="title-tile" style="animation-delay: 0.3s">P</div>
                <div class="title-tile" style="animation-delay: 0.4s">A</div>
            </div>
            <div class="title-row">
                <div class="title-tile" style="animation-delay: 0.5s">D</div>
                <div class="title-tile" style="animation-delay: 0.6s">E</div>
                <div class="title-spacer"></div>
                <div class="title-tile" style="animation-delay: 0.7s">L</div>
                <div class="title-tile" style="animation-delay: 0.8s">E</div>
                <div class="title-tile" style="animation-delay: 0.9s">T</div>
                <div class="title-tile" style="animation-delay: 1.0s">R</div>
                <div class="title-tile" style="animation-delay: 1.1s">A</div>
                <div class="title-tile" style="animation-delay: 1.2s">S</div>
            </div>
        </div>

        <p style="font-size: 1.2rem; opacity: 0.9; margin-top: 10px; text-align: center; max-width: 90%;">Desaf√≠a tu mente y llega a lo m√°s alto</p>
        
        <div class="menu-buttons">
            <button class="btn-start" onclick="showModeSelection()">
                <span class="btn-text">JUGAR</span>
            </button>

            <button class="btn-start" onclick="showScoreboard()">
                <span class="btn-text">SCORE GLOBAL üèÜ</span>
            </button>

            <button class="btn-start" onclick="shareGame()">
                <span class="btn-text">COMPARTIR üîó</span>
            </button>
        </div>
    </div>

    <!-- SELECCI√ìN DE MODO -->
    <div id="mode-screen" class="hidden">
        <div class="title-container">
            <div class="title-row">
                <div class="title-tile static">E</div>
                <div class="title-tile static">L</div>
                <div class="title-tile static">I</div>
                <div class="title-tile static">G</div>
                <div class="title-tile static">E</div>
            </div>
            <div class="title-row">
                <div class="title-tile static">T</div>
                <div class="title-tile static">U</div>
                <div class="title-spacer"></div>
                <div class="title-tile static">D</div>
                <div class="title-tile static">E</div>
                <div class="title-tile static">S</div>
                <div class="title-tile static">A</div>
                <div class="title-tile static">F</div>
                <div class="title-tile static">√ç</div>
                <div class="title-tile static">O</div>
            </div>
        </div>
        <div style="display: flex; flex-direction: column; gap: 20px; align-items: center;">
            <div class="mode-btn" onclick="startMode('traditional')">
                <span class="mode-title">Tradicional üßò</span>
                <span class="mode-desc">Sin prisa. Tu tiempo se suma al final.</span>
            </div>
            <div class="mode-btn elimination" onclick="startMode('elimination')">
                <span class="mode-title">Eliminaci√≥n ‚è≥</span>
                <span class="mode-desc">Cuenta regresiva. ¬°Gana tiempo encontrando palabras!</span>
            </div>
        </div>
        <button class="menu-btn" style="position: relative; margin-top: 30px;" onclick="goToMenu()">Volver</button>
    </div>

    <!-- PANTALLA SCOREBOARD -->
    <div id="scoreboard-screen" class="hidden">
        <div class="title-container" style="margin-bottom: 20px;">
            <div class="title-row">
                <div class="title-tile static">R</div>
                <div class="title-tile static">√â</div>
                <div class="title-tile static">C</div>
                <div class="title-tile static">O</div>
                <div class="title-tile static">R</div>
                <div class="title-tile static">D</div>
                <div class="title-tile static">S</div>
            </div>
        </div>
        <ul id="score-list" class="score-list">
            <li class="score-item">Cargando...</li>
        </ul>
        <button class="menu-btn" style="position: relative; top:0; left:0; margin-top: 30px;" onclick="goToMenu()">Volver</button>
    </div>

    <!-- PANTALLA DE JUEGO -->
    <div id="game-screen" class="hidden">
        <button class="menu-btn" onclick="confirmExit()">Men√∫</button>

        <div class="info-bar">
            <div class="info-pill" id="level-indicator">Nivel 1</div>
            <div class="info-pill" id="timer">00:00</div>
        </div>

        <div id="status-msg">Selecciona inicio y fin</div>

        <div class="game-layout">
            <div class="grid-wrapper">
                <div id="grid"></div>
            </div>
            <div class="words-panel">
                <h3>Palabras Ocultas</h3>
                <ul id="word-list"></ul>
            </div>
        </div>
    </div>

    <!-- MODAL CONFIRMACI√ìN -->
    <div id="confirm-modal" class="hidden">
        <div class="modal-content">
            <span class="thinking-emoji">ü§î</span>
            <h3>¬øSalir al Men√∫?</h3>
            <p>Perder√°s tu progreso actual.</p>
            <div class="modal-buttons">
                <button class="modal-btn btn-yes" onclick="goToMenu()">S√≠, salir</button>
                <button class="modal-btn btn-no" onclick="closeConfirm()">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- GAME OVER SCREEN (SOLO ELIMINACI√ìN) -->
    <div id="game-over-screen" class="hidden">
        <div class="title-container">
            <div class="title-row">
                <div class="title-tile static">G</div>
                <div class="title-tile static">A</div>
                <div class="title-tile static">M</div>
                <div class="title-tile static">E</div>
            </div>
            <div class="title-row">
                <div class="title-tile static">O</div>
                <div class="title-tile static">V</div>
                <div class="title-tile static">E</div>
                <div class="title-tile static">R</div>
            </div>
        </div>
        <!-- Contenedor centrado para los botones -->
        <div id="revive-container">
            <p style="margin-bottom: 10px; font-size: 1.1rem; opacity: 0.9;">¬øQuieres una segunda oportunidad?</p>
            <button class="btn-revive" onclick="revivePlayer()">‚ù§Ô∏è Revivir (+30s)</button>
        </div>
        <!-- Nuevo estilo de bot√≥n secundario -->
        <button class="btn-secondary" onclick="goToMenu()">Salir al Men√∫</button>
    </div>

    <!-- PANTALLA NIVEL COMPLETADO / FINAL -->
    <div id="level-complete-screen" class="hidden">
        <div id="level-complete-title-container" class="title-container" style="margin-bottom: 20px;"></div>
        <div id="level-stats">Tiempo Total: 00:00</div>
        
        <button id="btn-next" class="btn-start" onclick="nextLevelWithAnimation()">
            <span class="btn-text">Siguiente Nivel</span>
        </button>

        <div id="final-form" class="hidden">
            <input type="text" id="player-name-input" placeholder="Tu Nombre (M√°x 14)" maxlength="14">
            <button id="btn-save" class="btn-start" onclick="saveScore()">
                <span class="btn-text">Guardar</span>
            </button>
        </div>
    </div>

    <!-- INSTALAR JUEGO -->
    <div id="install-modal" class="hidden">
        <div class="modal-content">
            <span class="thinking-emoji">üì≤</span>
            <h3>¬°Instala la App!</h3>
            <p>Juega sin internet y a pantalla completa para una mejor experiencia.</p>
            <div class="modal-buttons">
                <button class="modal-btn btn-yes" onclick="installApp()">Instalar</button>
                <button class="modal-btn btn-no" onclick="closeInstallModal()">Ahora no</button>
            </div>
        </div>
    </div>

    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
            navigator.serviceWorker.register('./sw.js')
                .then(reg => console.log('Service Worker registrado', reg))
                .catch(err => console.error('Error al registrar SW', err));
            });
        }
    </script>

    <!-- Enlace al archivo de l√≥gica JavaScript -->
    <script type="module" src="funcionalidad.js"></script>
</body>
</html>